@page "/"
@using PAWPALme.Models
@using PAWPALme.Repositories
@inject IPetRepository PetRepo

<PageTitle>PawPal - Find Your Friend</PageTitle>

<div class="px-4 py-5 my-5 text-center bg-light rounded-3 shadow-sm">
    <h1 class="display-5 fw-bold text-primary">Welcome to PawPal</h1>
    <div class="col-lg-6 mx-auto">
        <p class="lead mb-4">Connecting loving homes with pets in need.</p>
        <div class="d-grid gap-2 d-sm-flex justify-content-sm-center">
            <a href="pets" class="btn btn-primary btn-lg px-4 gap-3">Browse All Pets</a>

            @* This link now matches the sidebar perfectly *@
            <a href="shelter/register" class="btn btn-outline-secondary btn-lg px-4">Register a Shelter</a>
        </div>
    </div>
</div>

<div class="container">
    <h3 class="mb-4 text-center">Featured Pets</h3>

    @if (pets == null)
    {
        <div class="text-center">
            <div class="spinner-border text-primary" role="status"></div>
        </div>
    }
    else if (!pets.Any())
    {
        <div class="alert alert-info text-center">No pets are currently available for adoption. Check back soon!</div>
    }
    else
    {
        <div class="row row-cols-1 row-cols-md-3 g-4">
            @foreach (var pet in pets.Take(3))
            {
                <div class="col">
                    <div class="card h-100 shadow-sm border-0">
                        <div style="height: 250px; overflow: hidden;" class="bg-secondary bg-opacity-10 d-flex align-items-center justify-content-center">
                            @if (!string.IsNullOrEmpty(pet.ImageUrl))
                            {
                                <img src="@pet.ImageUrl" style="width: 100%; height: 100%; object-fit: cover;" alt="@pet.Name">
                            }
                            else
                            {
                                <span class="text-muted"><i class="bi bi-camera"></i> No Image</span>
                            }
                        </div>
                        <div class="card-body text-center">
                            <h5 class="card-title fw-bold">@pet.Name</h5>
                            <p class="card-text text-muted">@pet.Breed • @pet.Age yrs</p>
                            <a href="pet/@pet.Id" class="btn btn-outline-primary btn-sm">View Details</a>
                        </div>
                    </div>
                </div>
            }
        </div>
        <div class="text-center mt-4">
            <a href="pets" class="btn btn-link">View All Pets &rarr;</a>
        </div>
    }
</div>

@code {
    private IEnumerable<Pet>? pets;

    protected override async Task OnInitializedAsync()
    {
        pets = await PetRepo.GetAllAsync();
    }
}